<h3>
  Notes on Chapter 8 - Week 2 of Nand2Tetris Part 2
</h3>
<br />
<br />
<h3>Unit 2.4: Function Call and Return: Implementation Preview</h3>
<ul>
  <li>We create state when we run a function</li>
  <li>We have to save the state and return to it when calling a new function</li>
  <li>When the function returns, we recycle the state</li>
  <li>The Calling pattern is LIFO, Last In First Out</li>
</ul>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_1.png" alt="">
</div>
<ul>
  <li>The frame is the return address and the memory segments of the caller (LCL, ARG, THIS, THAT)</li>
  <li>1. Copy the return value onto argument 0</li>
  <li>2. Restores the segment pointers of the caller</li>
  <li>3. Clears the stack</li>
  <li>4. Sets SP for the caller</li>
  <li>5 Jumps to the return address within the caller's code</li>
  <li>This is complicated, but this is not a surprise, because we are creating a little brain. It has the capacity to do one function, put it on hold, and then return to it when it's done. This is sophisticated, no wonder the implementation is non trivial.</li>
  <li>Very simple from the abstract view: call function, and get the result, but very complicated behind the scenes</li>
</ul>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_2.png" alt="">
</div>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_3.png" alt="">
</div>
<h3>Unit 2.5: Function Call and Return: Run-time Simulation</h3>
<ul>
<li>example of calling factorial of 3, run time simulation</li>
</ul>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_4.png" alt="">
</div>
<h3>
  Unit 2.6: Function Call and Return Implementation
</h3>
<ul>
  <li>Handling call:</li>
  <ul>
    <li> push returnAddress (using a label)</li>
    <li>push LCL, ARG, THIS, THAT // save of the caller</li>
    <li>ARG = SP - 5 - nArgs // Reposition ARG</li>
    <li>LCL = SP // Reposition LCL</li>
    <li>goto functionName // Transfers control to the called function</li>
    <li>(returnAddress) // Declare a label for the return-address</li>
  </ul>
</ul>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_5.png" alt="">
</div>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_6.png" alt="">
</div>
<br />
<h3>
  Unit 2.7: VM Implementation on the Hack Platform
</h3>
<ul>
  <li>VM programming convention: One file must be named Main.vm, with one function named main</li>
  <li>Bootstrap code: SP=256, Call Sys.init</li>
  <li>Special symbols</li>
</ul>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_7.png" alt="">
</div>
<h3>
  Unit 2.8: VM Translator: Proposed Implementation
</h3>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_8.png" alt="">
</div>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_9.png" alt="">
</div>
<div class="blog__image">
  <img src="../static/images/blog/notes/week_8_10.png" alt="">
</div>
<br />
<h3>Lecture Slides</h3>
<br />
<embed
    src="https://konradgnat.com/static/pdf/nand2Tetris_chapter_8_slides.pdf"
    type="application/pdf"
    frameBorder="0"
    scrolling="auto"
    height="900px"
    width="100%"
></embed>
<br />
<h3>Chapter 8 from the course book</h3>
<br />
<embed
    src="https://konradgnat.com/static/pdf/nand2Tetris_chapter_8.pdf"
    type="application/pdf"
    frameBorder="0"
    scrolling="auto"
    height="900px"
    width="100%"
></embed>

